<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Battle of the Village</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
        <div id="ui-overlay">
            <div id="player-health"></div>
            <div id="warlord-health"></div>
            <div id="score">Score: 0</div>
        </div>
        <div id="high-scores-toggle" onclick="toggleHighScores()">
            <svg viewBox="0 0 24 24">
                <path d="M12 15.4L8.24 17.67L9.24 13.39L5.92 10.51L10.3 10.13L12 6.1L13.71 10.14L18.09 10.52L14.77 13.4L15.77 17.68L12 15.4Z"/>
            </svg>
        </div>
        <div id="fullscreen-toggle">
            <svg viewBox="0 0 24 24">
                <path d="M7,14H5v5h5v-2H7v-3z M5,10h2V7h3V5H5V10z M17,17h-3v2h5v-5h-2V17z M14,5v2h3v3h2V5H14z"/>
            </svg>
        </div>
        <div id="high-scores" class="high-scores">
            <h2>High Scores</h2>
            <div id="scores-list"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="{{ url_for('static', filename='js/sprites.js') }}"></script>
    <script src="{{ url_for('static', filename='js/audio.js') }}"></script>
    <script>
        function toggleHighScores() {
            const highScores = document.getElementById('high-scores');
            highScores.classList.toggle('visible');
        }

        // Fullscreen handling
        const fullscreenToggle = document.getElementById('fullscreen-toggle');
        const gameContainer = document.getElementById('game-container');

        fullscreenToggle.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                gameContainer.requestFullscreen()
                    .then(() => {
                        gameContainer.classList.add('fullscreen');
                        screen.orientation.lock('landscape')
                            .catch(() => {}); // Ignore if not supported
                    })
                    .catch(err => console.error(err));
            } else {
                document.exitFullscreen()
                    .then(() => {
                        gameContainer.classList.remove('fullscreen');
                        screen.orientation.unlock()
                            .catch(() => {}); // Ignore if not supported
                    })
                    .catch(err => console.error(err));
            }
        });

        // Handle fullscreen changes
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                gameContainer.classList.remove('fullscreen');
            }
        });
    </script>
    <script src="{{ url_for('static', filename='js/game.js') }}"></script>
</body>
</html>